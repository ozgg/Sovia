<section class="dream preview">
  <h1 class="<%= dream.privacy %> <%= dream.lucid? ? 'lucid' : '' %>"><%= link_to dream.title_for_view, dream %></h1>

  <div class="body">
    <%= raw preview(prepare_dream_text(dream, current_user)) %>
    <% if dream.count_passages > 2 %>
        <div class="more"><%= link_to t(:read_more), dream %></div>
    <% end %>
    <% if dream.patterns_cache.any? %>
        <div class="tags">
          <span><%= t('dreams.form.grains') %>:</span>
          <% dream.patterns_cache.each do |tag_name| %>
              <%= link_to tag_name, tagged_dreams_path(tag_name: Canonizer.urlize(tag_name)), rel: 'tag' %>
          <% end %>
        </div>
    <% end %>
  </div>

  <div class="footer">
    <%= render partial: 'shared/author_and_time', locals: { item: dream } %>
    <div class="count"><%= link_to t('comment', count: dream.comments_count), dream %></div>
  </div>
  <%= render partial: 'shared/track_data', locals: { item: dream } %>
</section>
