<%= render partial: 'shared/list_of_errors', locals: { entity: entity } %>

<%= form_for entity do |f| %>
    <figure class="preview" id="post-image">
      <% if entity.image.blank? %>
          <%= image_tag 'image-placeholder.png' %>
      <% else %>
          <%= image_tag entity.image.medium.url %>
      <% end %>
      <figcaption>
        <%= f.label :image %>
        <%= f.file_field :image, accept: 'image/jpeg,image/png', data: { image: 'post-image' } %>
      </figcaption>
    </figure>

    <div>
      <%= f.check_box :visible %>
      <%= f.label :visible %>
    </div>
    <div>
      <%= f.label :title %><br />
      <%= f.text_field :title, size: 50, mexlength: Post::TITLE_LIMIT, required: true %>
    </div>
    <div>
      <%= f.label :lead %><br/>
      <%= f.text_area :lead, cols: 80, rows: 5, required: true %>
    </div>
    <div>
      <%= f.label :body %><br/>
      <%= f.text_area :body, cols: 80, rows: 25, required: true %>
    </div>

    <fieldset>
      <legend><%= t('posts.form.tags') %></legend>
      <% Tag.visible.ordered_by_slug.each do |tag| %>
          <div>
            <%= check_box_tag 'tag_ids[]', tag.id, tag.has_post?(entity), id: "tag_id_#{tag.id}" %>
            <%= label_tag "tag_id_#{tag.id}", tag.name %> (<%= t(:post, count: tag.posts_count) %>)
          </div>
      <% end %>
    </fieldset>

    <%= render partial: 'posts/form/figures', locals: { entity: entity } %>

    <div>
      <%= f.button t(:save), type: :submit %>
    </div>
<% end %>
